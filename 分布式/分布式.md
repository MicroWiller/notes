# 分布式



## 概念


1. 分布式是`系统部署方式`，服务是分散部署在不同的机器上
2. 微服务是`架构设计风格`，很小的服务，小到一个服务只对应一个单一的功能，只做一件事

区别：

- 生产环境下的微服务肯定是分布式部署的，分布式部署的应用不一定是微服务架构的

- 比如`集群部署`，它是把相同应用复制到不同服务器上，**但是逻辑功能上还是单体应用** 



- 在《分布式系统原理与范型》一书中有如下定义：“分布式系统是若干独立计算机的集合，这些计算机对于用户来说就像单个相关系统”；





## 特点



### 分布性

每个部分都可以独立部署，服务之间交互通过网络进行通信，比如：订单服务、商品服务



### 伸缩性

每个部分都可以**集群**方式部署，并可针对部分结点进行*硬件及软件扩容*，具有一定伸缩能力

？？哈希一致性？？



### 高可用

每部分都可以集群部署，保证高可用





## 分布式锁

|            单机场景            |                      分布式场景                      |
| :---------------------------: | :-------------------------------------------------: |
| 使用`语言的内置锁`来实现进程同步 | 使用`分布式锁`来实现可能位于不同节点（机器）上的进程同步 |

***

阻塞锁通常使用互斥量来实现：

| 互斥量 | 0（false） | 1（true） |
| :----: | :--------: | :-------: |
|  状态  |    锁定    |  未锁定   |
`互斥量`的表示：1 和 0 可以用一个**整型值**表示，也可以用**某个数据是否存在**表示

***

某个数据是否存在表示：

|     |  数据库的唯一索引  |    Redis 的 SETNX 指令    | Redis 的 RedLock 算法 |                Zookeeper 的有序节点                |
| --- | ---------------- | ------------------------ | -------------------- | ------------------------------------------------- |
| 实现 | 某一条记录是否存在 | 插入一个键值对 key是否存在 | 多个 Redis 实例       | 是否为当前子节点列表中 `序号最小的`临时且有序的子节点 |


## 分布式事务

锁是让谁去做？？事务是操作时候的具体细节？？
